local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = game.Workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

local AimbotEnabled = false
local ESPEnabled = true

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

local function CreateButton(text, position)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 80, 0, 30)
    button.Position = position
    button.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    button.BackgroundTransparency = 0.3
    button.TextColor3 = Color3.new(1, 1, 1)
    button.Font = Enum.Font.SourceSansBold
    button.TextSize = 18
    button.Text = text
    button.Parent = ScreenGui
    
    local border = Instance.new("UIStroke")
    border.Thickness = 1
    border.Color = Color3.new(1, 1, 1)
    border.Parent = button
    
    return button
end

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(0, 150, 0, 30)
TitleLabel.Position = UDim2.new(0.85, -45, 0.65, 0)
TitleLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
TitleLabel.BackgroundTransparency = 0.3
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.Text = "Metra Project"
TitleLabel.Font = Enum.Font.SourceSansBold
TitleLabel.TextSize = 18
TitleLabel.Parent = ScreenGui

local border = Instance.new("UIStroke")
border.Thickness = 1
border.Color = Color3.new(1, 1, 1)
border.Parent = TitleLabel

local ToggleAimButton = CreateButton("Aim OFF", UDim2.new(0.85, 0, 0.85, 0))
local ToggleESPButton = CreateButton("ESP ON", UDim2.new(0.85, 0, 0.75, 0))

ToggleAimButton.MouseButton1Click:Connect(function()
    AimbotEnabled = not AimbotEnabled
    ToggleAimButton.Text = AimbotEnabled and "Aim ON" or "Aim OFF"
    ToggleAimButton.BackgroundColor3 = AimbotEnabled and Color3.fromRGB(50, 200, 50) or Color3.fromRGB(200, 50, 50)
end)

ToggleESPButton.MouseButton1Click:Connect(function()
    ESPEnabled = not ESPEnabled
    ToggleESPButton.Text = ESPEnabled and "ESP ON" or "ESP OFF"
    ToggleESPButton.BackgroundColor3 = ESPEnabled and Color3.fromRGB(50, 200, 50) or Color3.fromRGB(200, 50, 50)
end)

local function GetClosestEnemy()
    local closestEnemy = nil
    local closestDistance = math.huge

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Team ~= LocalPlayer.Team then
            local character = player.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                local enemyPosition, onScreen = Camera:WorldToViewportPoint(character.HumanoidRootPart.Position)
                if onScreen then
                    local distance = (Vector2.new(enemyPosition.X, enemyPosition.Y) - UserInputService:GetMouseLocation()).Magnitude
                    if distance < closestDistance then
                        closestEnemy = character
                        closestDistance = distance
                    end
                end
            end
        end
    end
    return closestEnemy
end

RunService.RenderStepped:Connect(function()
    if AimbotEnabled then
        local enemy = GetClosestEnemy()
        if enemy then
            local enemyPosition = Camera:WorldToViewportPoint(enemy.HumanoidRootPart.Position)
            local mousePos = UserInputService:GetMouseLocation()
            local moveDelta = Vector2.new(enemyPosition.X, enemyPosition.Y) - mousePos
            mousemoverel(moveDelta.X, moveDelta.Y)
        end
    end
end)
