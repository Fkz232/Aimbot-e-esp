local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local aimbotEnabled = false
local espEnabled = false

local function CreateESP(part)
    local BillboardGui = Instance.new("BillboardGui")
    BillboardGui.Name = "ESP"
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Size = UDim2.new(2, 0, 2, 0)
    BillboardGui.Adornee = part
    
    local Frame = Instance.new("Frame")
    Frame.Name = "Box"
    Frame.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    Frame.BackgroundTransparency = 0.7
    Frame.BorderSizePixel = 0
    Frame.Size = UDim2.new(1, 0, 1, 0)
    Frame.Parent = BillboardGui
    
    BillboardGui.Parent = part
end

for _, Player in ipairs(Players:GetPlayers()) do
    if Player ~= LocalPlayer then
        Player.CharacterAdded:Connect(function(Character)
            if espEnabled then
                CreateESP(Character.HumanoidRootPart)
            end
        end)
    end
end

local aimbotButton = Instance.new("TextButton")
aimbotButton.Size = UDim2.new(0, 200, 0, 50)
aimbotButton.Position = UDim2.new(0, 10, 0, 10)
aimbotButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
aimbotButton.TextColor3 = Color3.fromRGB(255, 255, 255)
aimbotButton.TextSize = 20
aimbotButton.Text = "Aimbot: OFF"
aimbotButton.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

local function ToggleAimbot()
    aimbotEnabled = not aimbotEnabled
    if aimbotEnabled then
        aimbotButton.Text = "Aimbot: ON"
        while aimbotEnabled do
            local NearestPlayer = nil
            local NearestDistance = math.huge
            
            for _, Player in ipairs(Players:GetPlayers()) do
                if Player ~= LocalPlayer and Player.Character and Player.Character.Humanoid.Health > 0 then
                    local Distance = (Player.Character.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                    if Distance < NearestDistance then
                        NearestPlayer = Player
                        NearestDistance = Distance
                    end
                end
            end
            
            if NearestPlayer then
                local LookVector = (NearestPlayer.Character.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Unit
                local NewLook = CFrame.new(LocalPlayer.Character.HumanoidRootPart.Position, LocalPlayer.Character.HumanoidRootPart.Position + LookVector)
                LocalPlayer.Character.HumanoidRootPart.CFrame = NewLook
            end
            
            wait(0.1)
        end
    else
        aimbotButton.Text = "Aimbot: OFF"
    end
end

aimbotButton.MouseButton1Click:Connect(ToggleAimbot)

local espButton = Instance.new("TextButton")
espButton.Size = UDim2.new(0, 200, 0, 50)
espButton.Position = UDim2.new(0, 10, 0, 70)
espButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
espButton.TextColor3 = Color3.fromRGB(255, 255, 255)
espButton.TextSize = 20
espButton.Text = "ESP: OFF"
espButton.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

local function ToggleESP()
    espEnabled = not espEnabled
    if espEnabled then
        espButton.Text = "ESP: ON"
        for _, Player in ipairs(Players:GetPlayers()) do
            if Player ~= LocalPlayer and Player.Character then
                CreateESP(Player.Character.HumanoidRootPart)
            end
        end
    else
        espButton.Text = "ESP: OFF"
        for _, Player in ipairs(Players:GetPlayers()) do
            if Player.Character then
                local esp = Player.Character:FindFirstChild("ESP")
                if esp then
                    esp:Destroy()
                end
            end
        end
    end
end

espButton.MouseButton1Click:Connect(ToggleESP)
